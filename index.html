<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiple Imputation for Exploratory Factor Analysis • mifa</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Multiple Imputation for Exploratory Factor Analysis">
<meta property="og:description" content="Impute the covariance matrix of incomplete data so that factor 
  analysis can be performed. Imputations are made using multiple imputation 
  by Multivariate Imputation with Chained Equations (MICE) and combined with 
  Rubin's rules. Parametric Fieller confidence intervals and nonparametric
  bootstrap confidence intervals can be obtained for the variance explained by 
  different numbers of principal components.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">mifa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/teebusch/mifa/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="mifa---multiple-imputation-for-factor-analysis" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#mifa---multiple-imputation-for-factor-analysis" class="anchor"></a>mifa - multiple imputation for factor analysis</h1></div>
<p><img src="reference/figures/logo.png" align="right" height="139"></p>
<!-- badges: start -->

<!-- badges: end -->
<p><code>mifa</code> is an R package that implements multiple imputation of covariance matrices to allow to perform factor analysis on incomplete data. It works as follows:</p>
<ol>
<li><p>Impute missing values multiple times using <em>Multivariate Imputation with Chained Equations</em> (MICE) from the <a href="https://amices.org/mice/">mice</a> package.</p></li>
<li><p>Combine the covariance matrices of the imputed data sets into a single covariance matrix using Rubin’s rules<sup>[1]</sup></p></li>
<li><p>Use the combined covariance matrix for exploratory factor analysis.</p></li>
</ol>
<p><code>mifa</code> also provides two types of confidence intervals for the variance explained by different numbers of principal components: Fieller confidence intervals (parametric) for larger samples<sup>[2]</sup> and bootstrapped confidence intervals (nonparametric) for smaller samples.<sup>[3]</sup></p>
<p><strong>For more information about the method, see:</strong></p>
<p>Nassiri, V., Lovik, A., Molenberghs, G., Verbeke, G. (2018). On using multiple imputation for exploratory factor analysis of incomplete data. <em>Behavior Research Methods</em> 50, 501–517. <a href="https://doi.org/10.3758/s13428-017-1013-4">(link)</a></p>
<p><em>Note:</em> The paper was accompanied by an implementation in R, and this package emerged from it. The repository appears to have been abandoned by the authors, but you can still find it <a href="https://github.com/vahidnassiri/mifa">here</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install <code>mifa</code> from <a href="https://github.com/teebusch/mifa">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"teebusch/mifa"</span><span class="op">)</span></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div id="example-data" class="section level3">
<h3 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example Data</h3>
<p>For this example we use the <code>bfi</code> data set from the <code>psych</code> package. It contains 2,800 subjects’ answers to 25 personality self-report items and 3 demographic variables (sex, education, and age). Each of the 25 personality questions is meant to tap into one of the “Big 5” personality factors, as indicated by their names: <strong>O</strong>penness, <strong>C</strong>onscientiousness, <strong>A</strong>greeableness, , <strong>E</strong>xtraversion, <strong>N</strong>euroticism. There are missing responses for most items. Instead of dropping the incomplete cases from the analysis, we will use <code>mifa</code> to impute them, and then perform a factor analysis on the imputed covariance matrix.</p>
</div>
<div id="imputing-the-covariance-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#imputing-the-covariance-matrix" class="anchor"></a>Imputing the Covariance Matrix</h3>
<p>First, we use <code><a href="reference/mifa.html">mifa()</a></code> to impute the covariance matrix and get an idea how many factors we should use. We use the <code>cov_vars</code> argument to tell <code>mifa</code> to use <code>gender</code>, <code>education</code>, and <code>age</code> for the imputations, but exclude them from the covariance matrix:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/teebusch/mifa">mifa</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span>

<span class="va">mi</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mifa.html">mifa</a></span><span class="op">(</span>
  data      <span class="op">=</span> <span class="va">bfi</span>, 
  cov_vars  <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">education</span>, <span class="va">age</span><span class="op">)</span>,
  n_pc      <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>, 
  ci        <span class="op">=</span> <span class="st">"fieller"</span>, 
  print     <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="va">mi</span>
<span class="co">#&gt; Imputed covariance matrix of 25 variables</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable:   A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4 O5 </span>
<span class="co">#&gt; N Imputed:  16 27 26 19 16 21 24 20 26 16 23 16 25  9 21 22 21 11 36 29 22  0 28 14 20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of MICE imputations: 5</span>
<span class="co">#&gt; Additional variables used for imputations:</span>
<span class="co">#&gt; gender education age</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cumulative proportion of variance explained by n principal components:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; n  prop  Fieller CI    </span>
<span class="co">#&gt; 2  0.33  [0.32, 0.34]  </span>
<span class="co">#&gt; 3  0.41  [0.40, 0.42]  </span>
<span class="co">#&gt; 4  0.48  [0.47, 0.49]  </span>
<span class="co">#&gt; 5  0.54  [0.53, 0.55]  </span>
<span class="co">#&gt; 6  0.59  [0.58, 0.59]  </span>
<span class="co">#&gt; 7  0.62  [0.61, 0.63]  </span>
<span class="co">#&gt; 8  0.66  [0.65, 0.66]</span></code></pre></div>
</div>
<div id="factor-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#factor-analysis" class="anchor"></a>Factor Analysis</h3>
<p>It looks like the first 5 principal components explain more than half of the variance in the responses, so we perform a factor analysis with 5 factors, using the <code><a href="https://rdrr.io/pkg/psych/man/fa.html">fa()</a></code> function from the <code>psych</code> package. We can get the imputed covariance matrix of our data from <code>mi$cov_combined</code>. From there on, it’s business as usual.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op">(</span><span class="va">mi</span><span class="op">$</span><span class="va">cov_combined</span>, n.obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">bfi</span><span class="op">)</span>, nfactors <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>The factor diagram shows that the five factors correspond nicely to the 5 types of questions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.diagram.html">fa.diagram</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.svg"><!-- --></p>
<p>We can add the factor scores to the original data, in order to explore group differences. Because we need complete data to calculate factor scores, we first impute a single data set with mice:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_imp</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/complete.mids.html">complete</a></span><span class="op">(</span><span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/mice.html">mice</a></span><span class="op">(</span><span class="va">bfi</span>, <span class="fl">1</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

<span class="va">fct_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/factor.scores.html">factor.scores</a></span><span class="op">(</span><span class="va">data_imp</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span>, <span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">scores</span><span class="op">)</span>

<span class="va">data_imp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  Gender        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">data_imp</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>,
  Extraversion  <span class="op">=</span> <span class="va">fct_scores</span><span class="op">$</span><span class="va">MR1</span>,
  Neuroticism   <span class="op">=</span> <span class="va">fct_scores</span><span class="op">$</span><span class="va">MR2</span>,
  Conscientious <span class="op">=</span> <span class="va">fct_scores</span><span class="op">$</span><span class="va">MR3</span>,
  Openness      <span class="op">=</span> <span class="va">fct_scores</span><span class="op">$</span><span class="va">MR4</span>,
  Agreeableness <span class="op">=</span> <span class="va">fct_scores</span><span class="op">$</span><span class="va">MR5</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">data_imp</span><span class="op">$</span><span class="va">Gender</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span></code></pre></div>
<p>Then we can visualize the group differences:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="va">data_imp2</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">data_imp</span>, <span class="op">-</span><span class="va">Gender</span>, <span class="st">"factor"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data_imp2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, linetype <span class="op">=</span> <span class="va">Gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">factor</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.svg"><!-- --></p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further Reading</h2>
<p>[1] Rubin D. B. Multiple imputation for nonresponse in surveys (2004). John Wiley &amp; Sons.</p>
<p>[2] Fieller, E. C. (1954). Some problems in interval estimation. Journal of the Royal Statistical Society. Series B (Methodological): 175-185.</p>
<p>[3] Shao, J. &amp; Sitter, R. R. (1996). Bootstrap for imputed survey data. Journal of the American Statistical Association 91.435 (1996): 1278-1288. <a href="https://dx.doi.org/10.1080/01621459.1996.10476997">(link)</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/teebusch/mifa/">https://​github.com/​teebusch/​mifa/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/teebusch/mifa/issues">https://​github.com/​teebusch/​mifa/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Vahid Nassiri <br><small class="roles"> Author </small>  </li>
<li>Anikó Lovik <br><small class="roles"> Author </small>  </li>
<li>Geert  Molenberghs <br><small class="roles"> Author </small>  </li>
<li>Geert  Verbeke <br><small class="roles"> Author </small>  </li>
<li>Tobias Busch <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/https://orcid.org/0000-0002-8390-7892" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
<li><a href="https://github.com/teebusch/mifa/actions"><img src="https://github.com/teebusch/mifa/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/Teebusch/mifa?branch=master"><img src="https://codecov.io/gh/Teebusch/mifa/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Vahid Nassiri, Anikó Lovik, Geert  Molenberghs, Geert  Verbeke, Tobias Busch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
