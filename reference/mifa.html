<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute covariance matrix of incomplete data using multiple imputation — mifa • mifa</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute covariance matrix of incomplete data using multiple imputation — mifa" />
<meta property="og:description" content="Compute covariance matrix of incomplete data using multiple imputation.
For multiple imputation, Multivariate Imputation by Chained Equations
(MICE) from the mice package is used.
Also provides variance explained by different numbers of factors with
Fieller (parametric) or bootstrap (nonparametric) confidence intervals." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mifa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/advanced-use.html">Advanced Usage</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/teebusch/mifa/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute covariance matrix of incomplete data using multiple imputation</h1>
    <small class="dont-index">Source: <a href='https://github.com/teebusch/mifa/blob/master/R/mifa.R'><code>R/mifa.R</code></a></small>
    <div class="hidden name"><code>mifa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute covariance matrix of incomplete data using multiple imputation.
For multiple imputation, Multivariate Imputation by Chained Equations
(MICE) from the mice package is used.
Also provides variance explained by different numbers of factors with
Fieller (parametric) or bootstrap (nonparametric) confidence intervals.</p>
    </div>

    <pre class="usage"><span class='fu'>mifa</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>cov_var</span>, <span class='va'>n_factors</span>, ci <span class='op'>=</span> <span class='cn'>FALSE</span>, conf <span class='op'>=</span> <span class='fl'>0.95</span>, n_boot <span class='op'>=</span> <span class='fl'>1000</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame with missing values coded as <code>NA</code>.</p></td>
    </tr>
    <tr>
      <th>cov_var</th>
      <td><p>Variables in <code>data</code> to calculate the covariance
matrix for. Supports (tidy selection)<code><a href='https://dplyr.tidyverse.org/reference/select.html'>dplyr::select()</a></code>. This allows to
select variables that are used for the imputations of missing values, but not
the calculations of the covariance matrix. This is especially useful when
there are categorical predictors that can improve the imputation of the
response variables, but for which covariance cannot be calculated.
By default, all variables in <code>data</code> are used for both, the imputation and
the covariance matrix. Note: Variables and rows used for the imputation
can be configured using the <code>...</code>. See also <code><a href='https://amices.org/mice/reference/mice.html'>mice::mice()</a></code>.</p></td>
    </tr>
    <tr>
      <th>n_factors</th>
      <td><p>Integer or integer vector indicating number of factors for
which proportion of explained variance (and optionally confidence intervals)
should be indicated. Defaults to all possible numbers of factors.</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>A character string or character vector indicating which types of
confidence intervals should be constructed. If <code>"bootstrap"</code>, <code>"fieller"</code>,
or <code>"both"</code>, the corresponding intervals are computed. If <code>FALSE</code>
(the default) no confidence intervals will be computed.</p></td>
    </tr>
    <tr>
      <th>conf</th>
      <td><p>Confidence level for constructing confidence intervals. The
default is <code>.95</code>, i.e., a 95% confidence interval.</p></td>
    </tr>
    <tr>
      <th>n_boot</th>
      <td><p>number of bootstrap samples to use for the bootstrap confidence
intervals. The default is 1000.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Named arguments that will be passed to <code><a href='https://amices.org/mice/reference/mice.html'>mice::mice()</a></code>, such
as</p><ul>
<li><p><code>m</code> Number of generated imputations. The default is 5.</p></li>
<li><p><code>maxit</code> Number of iterations for each imputation. The default is 5.</p></li>
<li><p><code>method</code> Method used for imputation.</p></li>
<li><p><code>printFlag</code> Whether to print diagnostic information to console. The
default is TRUE).
See <code><a href='https://amices.org/mice/reference/mice.html'>mice::mice()</a></code> for all options.</p></li>
</ul></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list:</p><dl>
<dt>cov_combined</dt><dd><p>The estimated covariance matrix of the
incomplete data, based on the combined covariance matrices of imputed
data sets.</p></dd>
<dt>cov_imputations</dt><dd><p>A list containing the estimated covariance matrixes
for all imputed data sets.</p></dd>
<dt>var_explained</dt><dd><p>A data frame containing the estimated proportions of
explained variance for each of specified <code>n.factor</code> components. Depending o
n <code>ci</code>, it will also contain the estimated Fieller's (parametric) and/or
bootstrap (nonparametric) confidence interval for the proportion of
variance explained by the different numbers of factors defined by
<code>n_factors</code>.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Nassiri, V., Lovik, A., Molenberghs, G., &amp; Verbeke, G. (2018).
On using multiple imputation for exploratory factor analysis of incomplete
data. Behavioral Research Methods 50, 501–517.
<a href='https://doi.org/10.3758/s13428-017-1013-4'>https://doi.org/10.3758/s13428-017-1013-4</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='mifa_ci_boot.html'>mifa_ci_boot()</a></code>, <code><a href='mifa_ci_fieller.html'>mifa_ci_fieller()</a></code>, <code><a href='https://amices.org/mice/reference/mice.html'>mice::mice()</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Vahid Nassiri, Anikó Lovik, Geert  Molenberghs, Geert  Verbeke, Tobias Busch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


